services:
# ----- Auth management -----
    auth:
        class: an602\auth\auth

# ----- Auth providers -----
    auth.provider_collection:
        class: an602\auth\provider_collection
        arguments:
            - '@service_container'
            - '@config'
        tags:
            - { name: service_collection, tag: auth.provider }

    auth.provider.db:
        class: an602\auth\provider\db
        arguments:
            - '@captcha.factory'
            - '@config'
            - '@dbal.conn'
            - '@passwords.manager'
            - '@request'
            - '@user'
            - '%core.root_path%'
            - '%core.php_ext%'
        tags:
            - { name: auth.provider }

    auth.provider.apache:
        class: an602\auth\provider\apache
        arguments:
            - '@config'
            - '@dbal.conn'
            - '@language'
            - '@request'
            - '@user'
            - '%core.root_path%'
            - '%core.php_ext%'
        tags:
            - { name: auth.provider }

    auth.provider.ldap:
        class: an602\auth\provider\ldap
        arguments:
            - '@config'
            - '@dbal.conn'
            - '@language'
            - '@user'
        tags:
            - { name: auth.provider }

    auth.provider.oauth:
        class: an602\auth\provider\oauth\oauth
        arguments:
            - '@config'
            - '@dbal.conn'
            - '@auth.provider.db'
            - '@dispatcher'
            - '@language'
            - '@request'
            - '@auth.provider.oauth.service_collection'
            - '@user'
            - '%tables.auth_provider_oauth_token_storage%'
            - '%tables.auth_provider_oauth_states%'
            - '%tables.auth_provider_oauth_account_assoc%'
            - '%tables.users%'
            - '%core.root_path%'
            - '%core.php_ext%'
        tags:
            - { name: auth.provider }

# ----- OAuth services providers -----
    auth.provider.oauth.service_collection:
        class: an602\di\service_collection
        arguments:
            - '@service_container'
        tags:
            - { name: service_collection, tag: auth.provider.oauth.service }

    auth.provider.oauth.service.bitly:
        class: an602\auth\provider\oauth\service\bitly
        arguments:
            - '@config'
            - '@request'
        tags:
            - { name: auth.provider.oauth.service }

    auth.provider.oauth.service.facebook:
        class: an602\auth\provider\oauth\service\facebook
        arguments:
            - '@config'
            - '@request'
        tags:
            - { name: auth.provider.oauth.service }

    auth.provider.oauth.service.google:
        class: an602\auth\provider\oauth\service\google
        arguments:
            - '@config'
            - '@request'
        tags:
            - { name: auth.provider.oauth.service }

    auth.provider.oauth.service.twitter:
        class: an602\auth\provider\oauth\service\twitter
        arguments:
            - '@config'
            - '@request'
        tags:
            - { name: auth.provider.oauth.service }
