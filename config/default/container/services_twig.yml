parameters:
    core.template.cache_path: '%core.cache_dir%twig/'

services:
    template.twig.environment:
        class: an602\template\twig\environment
        arguments:
            - '@config'
            - '@filesystem'
            - '@path_helper'
            - '%core.template.cache_path%'
            - '@ext.manager'
            - '@template.twig.loader'
            - '@dispatcher'
            - []
        calls:
            - [setLexer, ['@template.twig.lexer']]

    template.twig.lexer:
        class: an602\template\twig\lexer
        lazy: true
        arguments:
            - '@template.twig.environment'

    template.twig.loader:
        class: an602\template\twig\loader
        arguments:
            - '@filesystem'

    template.twig.extensions.collection:
        class: an602\di\service_collection
        arguments:
            - '@service_container'
        tags:
            - { name: service_collection, tag: twig.extension }

    template.twig.extensions.an602:
        class: an602\template\twig\extension
        arguments:
            - '@template_context'
            - '@template.twig.environment'
            - '@language'
        tags:
            - { name: twig.extension }

    template.twig.extensions.avatar:
        class: an602\template\twig\extension\avatar
        tags:
            - { name: twig.extension }

    template.twig.extensions.config:
        class: an602\template\twig\extension\config
        arguments:
            - '@config'
        tags:
            - { name: twig.extension }

    template.twig.extensions.routing:
        class: an602\template\twig\extension\routing
        arguments:
            - '@routing.helper'
        tags:
            - { name: twig.extension }

    template.twig.extensions.username:
        class: an602\template\twig\extension\username
        tags:
            - { name: twig.extension }

    template.twig.extensions.debug:
        class: Twig\Extension\DebugExtension

    template:
        class: an602\template\twig\twig
        arguments:
            - '@path_helper'
            - '@config'
            - '@template_context'
            - '@template.twig.environment'
            - '%core.template.cache_path%'
            - '@user'
            - '@template.twig.extensions.collection'
            - '@ext.manager'

    template_context:
        class: an602\template\context
